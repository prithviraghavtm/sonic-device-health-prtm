APIs

/* Clientside APIs */

RegisterClient:
    Register client by name

    Expect unique name from clients
    Duplicate registration fails

    Client name is passed to Engine.
    
    Engine clear any cache it may have for that client.

    input:
        client_name str

    output:
        none

    Return code:
        0 - On success. Implies registration reached Engine.
     != 0 - On Failure
    


DeregisterClient:
    Forward the de-register to engine.
    Engine clear any cache it may have for that client.

    Duplicate is no-op

    input:
        none

    output:
        none

    Return code:
        0 - On success. Implies deregistration reached Engine.
     != 0 - On Failure
    

RegisterAction:
    Register action by name

    Expect unique name from this client.
    Engine ensures that this action is globally unique among registered.

    input:
        action_name str

    output:
        none

    Return code:
        0 - On success. Implies registration reached Engine.
     != 0 - On Failure
    
    
DeregisterAction:
    Deregister action by name

    if this client has registered this action, send it to engine.
    Engine clears this action.

    input:
        action_name str

    output:
        none

    Return code:
        0 - On success. Implies deregistration reached Engine.
     != 0 - On Failure
    
    
touch heartbeat:
    Touch heartbeat by action for active request.

    Expect action is pre-registered.
    
    input:
        action_name str
        instance-id str     // Instance ID provided for this action's request

    output:
        none

    Return code:
        0 - On success. Implies heartbeat reached Engine.
     != 0 - On Failure
    


read_action_request:
    Read action request sent by Engine to one of the registered actions or
    shutdown request.

    On shutdown, engine clears all cache w.r.t this client.

    input:
        timeout int
            0 - Implies no wait
          > 0 - Count of milliseconds to wait for a request
          < 0 - Wait forever until a request

    output:
        request - Object - TODO

    Return code:
        0 - On success. Implies registration reached Engine.
     != 0 - On Failure
    

write_action_response:
    Write action response sent by action to Engine.

    input:
        response - Object - TODO

    output:
        request

    Return code:
        0 - On success. Implies registration reached Engine.
     != 0 - On Failure
    

client_poll_for_data:
    Poll for request from Engine or other FDs.

    input:
        lst_fds  - List of fds
        timeout int
            0 - Implies no wait
          > 0 - Count of milliseconds to wait for a request
          < 0 - Wait forever until a request

    output:
        rdfds - Set of fds with data

    Return code:
        0 - On success. Implies registration reached Engine.
     != 0 - On Failure
    

/* Serverside APIs */

server_read_request:
    Reads all client requests as client object

    input:
        none

    output:
        client object

    Return code:
        0 - On success. Implies registration reached Engine.
     != 0 - On Failure
    


server_write_request:
    Writes request to a specific client.
    It could be either action request to a client's action or shutdown.

    input:
        request object

    output:
        none

    Return code:
        0 - On success. Implies registration reached Engine.
     != 0 - On Failure
    
    
